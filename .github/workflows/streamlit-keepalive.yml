name: streamlit-keepalive

on:
  schedule:
    - cron: "0 */4 * * *"   # 每4小时一次（比6小时更稳，防止cron漂移导致超过12小时）
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Streamlit app
        run: |
          URL="https://nursecall-demo.streamlit.app/"
          curl -L --max-time 60 --retry 2 --retry-delay 10 "$URL" > /tmp/page.html || true
          if grep -qi "gone to sleep" /tmp/page.html; then
            echo "Returned sleep page. If this persists, increase frequency or add click-to-wake workflow."
          else
            echo "Ping OK."
          fi

